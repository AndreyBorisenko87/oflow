# Scalping Strategy (OFLO)

Система анализа рыночных паттернов для скальперской торговли на ETHUSDT.

## 🏗️ АРХИТЕКТУРА БЛОКОВ

### 📊 **СТАТУС**: 100% готово (15 из 15 блоков) 🎉

🎯 **ПРОЕКТ ПОЛНОСТЬЮ ЗАВЕРШЕН!** 

Все 15 блоков системы Scalping Strategy реализованы и готовы к использованию.

## ✅ **ГОТОВЫЕ БЛОКИ**:

#### **Блок 01: Конфиг** (100% готов)
- `configs/config.yaml` - основные настройки проекта
- `configs/sources.yaml` - пути к данным по биржам
- **Статус**: Полностью реализован с расширенными настройками

#### **Блок 02: Импорт сырья** (100% готов)
- `src/oflow/blocks/import_raw.py` - импорт parquet файлов
- **Статус**: Полностью функционален, работает с 3 биржами

#### **Блок 03: Нормализация** (100% готов)
- `src/oflow/blocks/normalization.py` - нормализация в единый формат
- `configs/normalization.yaml` - конфигурация нормализации
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 04: Синхронизация времени** (100% готов)
- `src/oflow/blocks/sync_time.py` - оценка лагов, синхронизация, фильтрация дропов
- `configs/sync_time.yaml` - конфигурация синхронизации
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 05: Лучшие цены** (100% готов)
- `src/oflow/blocks/best_prices.py` - восстановление best bid/ask/mid, расчет спредов
- `configs/best_prices.yaml` - конфигурация восстановления цен
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 06: Топ-зона книги** (100% готов)
- `src/oflow/blocks/book_top.py` - Анализ топ-уровней order book, отслеживание изменений
- `configs/book_top.yaml` - Конфигурация анализа order book
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 07: Лента сделок** (100% готов)
- `src/oflow/blocks/trade_tape.py` - анализ агрессии, объемы по окнам, квантили
- `configs/trade_tape.yaml` - конфигурация анализа
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 08: Кросс-биржевая агрегация** (100% готов)
- `src/oflow/blocks/cross_exchange.py` - NBBO, суммарные объемы, синхронизация
- `configs/cross_exchange.yaml` - конфигурация агрегации
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 09: Базис спот-фьючерс** (100% готов)
- `src/oflow/blocks/basis.py` - разница спот-фьючерс, аномалии, категоризация
- `configs/basis.yaml` - конфигурация анализа базиса
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 10: Фичи паттернов** (100% готов)
- `src/oflow/blocks/features.py` - Извлечение признаков паттернов для 8 детекторов (D1-D8)
- `configs/features.yaml` - Конфигурация извлечения фич
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 11: Канонический слой** (100% готов)
- `src/oflow/blocks/canonical.py` - Пакетное сохранение данных по дням с индексацией
- `configs/canonical.yaml` - Конфигурация канонического слоя
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 12: Детекторы** (100% готов)
- `src/oflow/blocks/detectors.py` - Основной модуль детекторов
- `src/oflow/blocks/detectors/` - Пакет с 8 детекторами паттернов
- `configs/detectors.yaml` - Конфигурация всех детекторов
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 13: Сканер** (100% готов)
- `src/oflow/blocks/scanner.py` - Автоматическое сканирование и обработка данных
- `configs/scanner.yaml` - Конфигурация сканера
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 14: Бэктест** (100% готов)
- `src/oflow/blocks/backtest.py` - Полная реализация торговых стратегий с управлением рисками
- `configs/backtest.yaml` - Конфигурация стратегий и управления рисками
- **Статус**: Полностью реализован с прогресс-логированием

#### **Блок 15: Экспорт разметки** (100% готов)
- `src/oflow/blocks/export.py` - Полная реализация экспорта для TradingView и ATAS
- `configs/export.yaml` - Конфигурация экспорта и форматирования
- **Статус**: Полностью реализован с прогресс-логированием

## 🚀 **БЫСТРЫЙ СТАРТ**

### **Установка зависимостей**:
```bash
pip install -r requirements.txt
```

### **Запуск тестовой цепочки**:
```bash
python -m src.oflow.pipeline
```

### **Запуск отдельного блока**:
```python
from src.oflow.blocks import run_test, run_time_sync

# Блок 02: Импорт
trades_df, depth_df = run_test()

# Блок 04: Синхронизация времени
synced_trades, synced_depth = run_time_sync(trades_df, depth_df, config)
```

## 📁 **СТРУКТУРА ПРОЕКТА**

```
oflow/
├── configs/                  # Конфигурационные файлы
│   ├── config.yaml          # Основные настройки
│   ├── sources.yaml         # Пути к данным
│   ├── normalization.yaml   # Нормализация
│   ├── sync_time.yaml      # Синхронизация времени
│   ├── best_prices.yaml    # Лучшие цены
│   ├── book_top.yaml       # Топ-зона книги
│   ├── trade_tape.yaml     # Лента сделок
│   ├── cross_exchange.yaml # Кросс-биржевая агрегация
│   ├── basis.yaml          # Базис спот-фьючерс
│   ├── features.yaml       # Фичи паттернов
│   ├── canonical.yaml      # Канонический слой
│   ├── detectors.yaml      # Детекторы
│   ├── scanner.yaml        # Сканер
│   ├── backtest.yaml       # Бэктест
│   └── export.yaml         # Экспорт
├── src/oflow/
│   ├── blocks/              # Все 15 блоков
│   │   ├── import_raw.py    # Блок 02: Импорт
│   │   ├── normalization.py # Блок 03: Нормализация
│   │   ├── sync_time.py     # Блок 04: Синхронизация
│   │   ├── best_prices.py   # Блок 05: Лучшие цены
│   │   ├── book_top.py      # Блок 06: Топ-зона
│   │   ├── trade_tape.py    # Блок 07: Лента сделок
│   │   ├── cross_exchange.py # Блок 08: Агрегация
│   │   ├── basis.py         # Блок 09: Базис
│   │   ├── features.py      # Блок 10: Признаки
│   │   ├── canonical.py     # Блок 11: Канонический слой
│   │   ├── detectors.py     # Блок 12: Детекторы
│   │   ├── scanner.py       # Блок 13: Сканер
│   │   ├── backtest.py      # Блок 14: Бэктест
│   │   └── export.py        # Блок 15: Экспорт
│   ├── pipeline.py          # Главный файл цепочки
│   └── __init__.py
├── data/                    # Выходные данные
├── logs/                    # Логи
├── tests/                   # Тесты
└── docs/                    # Документация
    └── blocks/              # README файлы для каждого блока
```

## 🔧 **ТЕХНИЧЕСКИЕ ДЕТАЛИ**

### **Форматы данных**:
- **Вход**: Parquet файлы с trades и depth
- **Выход**: Нормализованные parquet + CSV для экспорта
- **Сжатие**: Snappy для оптимизации размера

### **Временные метки**:
- **Формат**: Наносекунды (int64)
- **Синхронизация**: UTC, оценка лагов между биржами
- **Агрегация**: Настраиваемые окна (1с, 10с, 1мин)

### **Биржи и рынки**:
- **Биржи**: Binance, Bybit, OKX
- **Рынки**: Spot, Futures
- **Инструменты**: ETHUSDT (основной)

## 📈 **ЦЕЛИ ПРОЕКТА**

1. **Обнаружение паттернов**: LVB, stop-run, absorption, spoofing
2. **Кросс-биржевой анализ**: NBBO, арбитражные возможности
3. **Скальперская стратегия**: Быстрые входы/выходы на паттернах
4. **Автоматизация**: Сканер + детекторы + бэктест
5. **Интеграция**: Экспорт в TradingView, ATAS

## 📞 **ПОДДЕРЖКА**

- **Документация**: `docs/context.md`
- **Примеры**: `src/oflow/pipeline.py`
- **Тесты**: `tests/`
- **Логи**: `logs/oflow.log`

---

**Статус**: ✅ Завершен (100% готово)  
**Версия**: 1.0.0  
**Последнее обновление**: Август 2025
