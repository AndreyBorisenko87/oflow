# –ë–ª–æ–∫ 02: –ò–º–ø–æ—Ä—Ç —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (ImportRaw)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ë–ª–æ–∫ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–º–ø–æ—Ä—Ç –∏ –ø–µ—Ä–≤–∏—á–Ω—É—é –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Å—ã—Ä—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –±–∏—Ä–∂. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç trades, depth (–∫–Ω–∏–≥–∞ –∑–∞—è–≤–æ–∫) –∏ quotes.

## üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ò–º–ø–æ—Ä—Ç trades** - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–¥–µ–ª–∫–∏ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º
- **–ò–º–ø–æ—Ä—Ç depth** - —Å–Ω–∞–ø—à–æ—Ç—ã –∫–Ω–∏–≥–∏ –∑–∞—è–≤–æ–∫ (bid/ask)
- **–ò–º–ø–æ—Ä—Ç quotes** - –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ –ª—É—á—à–∏—Ö —Ü–µ–Ω
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏** - –æ–±—Ä–µ–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
- **–í—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç**: Parquet —Ñ–∞–π–ª—ã —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **–í—ã—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç**: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ DataFrame —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Trades (—Å–¥–µ–ª–∫–∏):
```
ts_ns: int64           # Timestamp –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö
exchange: string       # –ù–∞–∑–≤–∞–Ω–∏–µ –±–∏—Ä–∂–∏
market: string         # –¢–∏–ø —Ä—ã–Ω–∫–∞ (spot/futures)
instrument: string     # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (ETH-USDT)
base_symbol: string    # –ë–∞–∑–æ–≤—ã–π —Å–∏–º–≤–æ–ª (ETHUSDT)
aggressor: string      # –°—Ç–æ—Ä–æ–Ω–∞ –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–∞ (buy/sell)
price: float64         # –¶–µ–Ω–∞ —Å–¥–µ–ª–∫–∏
size: float64          # –û–±—ä–µ–º —Å–¥–µ–ª–∫–∏
trade_id: string       # ID —Å–¥–µ–ª–∫–∏
_src_file: string      # –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
```

### Depth (–∫–Ω–∏–≥–∞ –∑–∞—è–≤–æ–∫):
```
ts_ns: int64           # Timestamp –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö
exchange: string       # –ù–∞–∑–≤–∞–Ω–∏–µ –±–∏—Ä–∂–∏
market: string         # –¢–∏–ø —Ä—ã–Ω–∫–∞
symbol: string         # –°–∏–º–≤–æ–ª
side: string           # –°—Ç–æ—Ä–æ–Ω–∞ (bid/ask)
price: float64         # –¶–µ–Ω–∞ —É—Ä–æ–≤–Ω—è
size: float64          # –û–±—ä–µ–º –Ω–∞ —É—Ä–æ–≤–Ω–µ
action: string         # –î–µ–π—Å—Ç–≤–∏–µ (update/del)
_src_file: string      # –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
```

### Quotes (–∫–æ—Ç–∏—Ä–æ–≤–∫–∏):
```
ts_ns: int64           # Timestamp –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö
exchange: string       # –ù–∞–∑–≤–∞–Ω–∏–µ –±–∏—Ä–∂–∏
market: string         # –¢–∏–ø —Ä—ã–Ω–∫–∞
symbol: string         # –°–∏–º–≤–æ–ª
best_bid: float64      # –õ—É—á—à–∏–π bid
best_ask: float64      # –õ—É—á—à–∏–π ask
mid: float64           # –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞
spread: float64        # –°–ø—Ä–µ–¥
_src_file: string      # –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
input_dir: "data/raw"              # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
output_dir: "data/normalized"      # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
symbols: ["ETHUSDT"]               # –°–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
exchanges: ["binance", "bybit", "okx"]  # –°–ø–∏—Å–æ–∫ –±–∏—Ä–∂
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í —Å–æ—Å—Ç–∞–≤–µ –ø–∞–π–ø–ª–∞–π–Ω–∞:
```python
from oflow.pipeline import run_full_pipeline

# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
results = run_full_pipeline(
    config_dir='configs',
    test_mode=False
)
```

### –û—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–ª–æ–∫–∞:
```python
from oflow.blocks.import_raw import import_raw_data

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
config = {
    'input_dir': 'data/raw',
    'output_dir': 'data/normalized',
    'symbols': ['ETHUSDT'],
    'exchanges': ['binance']
}

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
data = {
    'data_paths': [
        'path/to/trades.parquet',
        'path/to/depth.parquet',
        'path/to/quotes.parquet'
    ],
    'start_time': None,  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    'end_time': None     # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
result = import_raw_data(data, config)
trades_df, depth_df = result
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Trades**: ~43K –∑–∞–ø–∏—Å–µ–π –∑–∞ 0.6 —Å–µ–∫
- **Depth**: ~1.3M –∑–∞–ø–∏—Å–µ–π –∑–∞ 70 —Å–µ–∫  
- **Memory**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- **Progress**: –ü—Ä–æ–≥—Ä–µ—Å—Å-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10K –∑–∞–ø–∏—Å–µ–π

## üîç –í–∞–ª–∏–¥–∞—Ü–∏—è

–ë–ª–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å timestamp

## üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ü—Ä–æ–ø—É—Å–∫ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞**: Graceful fallback
- **Memory overflow**: –ë–∞—Ç—á–∏–Ω–≥ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```
üöÄ === –ù–ê–ß–ê–õ–û –í–´–ü–û–õ–ù–ï–ù–ò–Ø ImportRawBlock ===
üìã –≠—Ç–∞–ø 1/3: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–π–¥–µ–Ω–∞
‚öôÔ∏è  –≠—Ç–∞–ø 2/3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
üîç –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è depth: 24040 –∑–∞–ø–∏—Å–µ–π...
üìä –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ 10000/24040 (41.6%)
‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è depth –∑–∞–≤–µ—Ä—à–µ–Ω–∞: 1319515 —Å—Ç—Ä–æ–∫
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
‚è±Ô∏è  –≠—Ç–∞–ø 3/3: –ó–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ 70.69—Å
üéâ === –ë–õ–û–ö ImportRawBlock –ó–ê–í–ï–†–®–ï–ù ===
```

## üîó –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –±–ª–æ–∫–∞–º–∏

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°—ã—Ä—ã–µ Parquet —Ñ–∞–π–ª—ã  
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: ‚Üí –ë–ª–æ–∫ 04 (SyncTime)

## üìö –ü—Ä–∏–º–µ—Ä—ã

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ trades:
```python
data = {
    'data_paths': ['data/binance-trades.parquet']
}
result = import_raw_data(data, config)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏:
```python
from datetime import datetime

data = {
    'data_paths': ['data/all-data.parquet'],
    'start_time': datetime(2025, 1, 1),
    'end_time': datetime(2025, 1, 2)
}
result = import_raw_data(data, config)
```
