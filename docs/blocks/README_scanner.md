# –ë–ª–æ–∫ 13: –°–∫–∞–Ω–µ—Ä –¥–∞–Ω–Ω—ã—Ö

## –û–±–∑–æ—Ä

–°–∫–∞–Ω–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤. –≠—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –≥–∏–±–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º, –±–∏—Ä–∂–∞–º –∏ —Å–∏–º–≤–æ–ª–∞–º

### 2. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –†–∞–∑–±–∏–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—Ç—á–µ—Ç—ã –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–º —Å–æ–±—ã—Ç–∏—è–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
DataScanner
‚îú‚îÄ‚îÄ scan_canonical_files()     # –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ create_batches()           # –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ load_batch_data()          # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ process_batch()            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
‚îî‚îÄ‚îÄ run_full_scan()            # –ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—Ç–µ–∫—Ü–∏—è
```

### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```mermaid
graph TD
    A[–ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–µ—Ä–∞] --> B[–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤]
    B --> C[–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º]
    C --> D[–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤]
    D --> E[–ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤]
    E --> F[–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤]
    F --> G{–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ?}
    G -->|–î–∞| H[ThreadPoolExecutor]
    G -->|–ù–µ—Ç| I[–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ]
    H --> J[–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    I --> J
    J --> K[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤]
    K --> L[–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤]
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from oflow.blocks.scanner import run_scanner
from pathlib import Path
import yaml

# –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
with open('configs/scanner.yaml', 'r') as f:
    scanner_config = yaml.safe_load(f)

with open('configs/detectors.yaml', 'r') as f:
    detectors_config = yaml.safe_load(f)

# –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
results = run_scanner(
    config=scanner_config,
    detectors_config=detectors_config,
    data_dir=Path("data/canon"),
    output_dir=Path("data/events")
)

# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for detector_name, events_df in results.items():
    if not events_df.empty:
        print(f"{detector_name}: –Ω–∞–π–¥–µ–Ω–æ {len(events_df)} —Å–æ–±—ã—Ç–∏–π")
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from oflow.blocks.scanner import DataScanner
from oflow.blocks.detectors import create_detectors_from_config

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫–∞–Ω–µ—Ä–∞ —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
config = {
    'processing': {
        'batch_size': 5,
        'max_workers': 2
    },
    'filters': {
        'date_range': {
            'start': '20241201',
            'end': '20241207'
        },
        'exchanges': ['binance', 'bybit']
    }
}

scanner = DataScanner(config)

# –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
data_dir = Path("data/canon")
output_dir = Path("data/events")

# 1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
found_files = scanner.scan_canonical_files(data_dir)
print(f"–ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {sum(len(files) for files in found_files.values())}")

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
batches = scanner.create_batches(found_files)
print(f"–°–æ–∑–¥–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {len(batches)}")

# 3. –ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
results = scanner.run_full_scan(data_dir, output_dir, detectors_config)
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```yaml
# –û–±—Ä–∞–±–æ—Ç–∫–∞
processing:
  batch_size: 10                    # –§–∞–π–ª–æ–≤ –≤ –ø–∞–∫–µ—Ç–µ
  max_workers: 4                    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
  memory_limit_gb: 8                # –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏

# –§–∏–ª—å—Ç—Ä—ã
filters:
  date_range:
    start: "20241201"               # –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
    end: "20241231"                 # –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞
  exchanges: ["binance", "bybit"]   # –¢–æ–ª—å–∫–æ —ç—Ç–∏ –±–∏—Ä–∂–∏
  symbols: ["ETHUSDT"]              # –¢–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Å–∏–º–≤–æ–ª
```

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

```yaml
modes:
  development:
    enabled: true
    limit_files_per_type: 10        # –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  
  production:
    enabled: false
    optimize_for_speed: true        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```

## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–∞–º

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç:

```yaml
filters:
  date_range:
    start: "20241201"    # –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)
    end: "20241231"      # –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)
```

–§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: `YYYYMMDD`. –û–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã.

### –§–∏–ª—å—Ç—Ä –ø–æ –±–∏—Ä–∂–∞–º

```yaml
filters:
  exchanges: ["binance", "bybit", "okx"]
```

–ò—â–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É (—Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ).

### –§–∏–ª—å—Ç—Ä –ø–æ —Å–∏–º–≤–æ–ª–∞–º

```yaml
filters:
  symbols: ["ETHUSDT", "BTCUSDT"]
```

–ò—â–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É (—Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ).

## –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤

–°–∫–∞–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–∞–∫–µ—Ç—ã —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```python
# –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–∫–µ—Ç–∞
batch = {
    'quotes': [Path('quotes_20241201_20241201.parquet')],
    'book_top': [Path('book_top_20241201_20241201.parquet')],
    'tape': [Path('tape_20241201_20241201.parquet')],
    'features': []  # –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
}
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

–ü—Ä–∏ `max_workers > 1` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏
config = {
    'processing': {
        'max_workers': 4,           # 4 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞
        'batch_size': 8             # 8 —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–∞–∫–µ—Ç
    }
}
```

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã

### 1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```python
def scan_canonical_files(self, data_dir: Path) -> Dict[str, List[Path]]:
    # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–¥–µ–∫—Å–∞ —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    # 2. –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö
    # 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    # 4. –í–æ–∑–≤—Ä–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
```

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```python
def _passes_filters(self, file_info: Dict, file_path: Path) -> bool:
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –¥–∞—Ç–µ
    if not self._check_date_filter(file_info, file_path):
        return False
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –±–∏—Ä–∂–∞–º
    if not self._check_exchange_filter(file_path):
        return False
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å–∏–º–≤–æ–ª–∞–º
    if not self._check_symbol_filter(file_path):
        return False
    
    return True
```

### 3. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```python
def process_batch(self, batch: Dict[str, List[Path]], detectors: List, 
                 output_dir: Path, batch_num: int) -> Dict[str, pd.DataFrame]:
    # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞
    batch_data = self.load_batch_data(batch)
    
    # 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
    if not self._validate_for_detectors(batch_data):
        return {}
    
    # 3. –ó–∞–ø—É—Å–∫ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
    results = run_detectors(detectors, batch_data, output_dir)
    
    return results
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã–≤–æ–¥–∞

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

```
data/events/
‚îú‚îÄ‚îÄ batch_001/                      # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ events_d1liquidityvacuumbreak.parquet
‚îÇ   ‚îú‚îÄ‚îÄ events_d2absorptionflip.parquet
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ batch_002/                      # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Ç–æ—Ä–æ–≥–æ –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ summary/                        # –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ final_d1liquidityvacuumbreak.parquet
‚îÇ   ‚îú‚îÄ‚îÄ final_d2absorptionflip.parquet
‚îÇ   ‚îú‚îÄ‚îÄ scan_report.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
```

### –û—Ç—á–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```json
{
  "scan_completed_at": "2024-12-01T12:00:00",
  "total_detectors": 8,
  "detectors_with_events": 3,
  "total_events": 1247,
  "detector_summary": {
    "D1LiquidityVacuumBreak": {
      "event_count": 45,
      "has_events": true
    },
    "D2AbsorptionFlip": {
      "event_count": 0,
      "has_events": false
    }
  }
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ñ–∞–π–ª–æ–≤**: –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ `file_index.json`
2. **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
3. **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
4. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**: –ò–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

```yaml
# –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
processing:
  batch_size: 5                     # –ú–µ–Ω—å—à–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–∞–∫–µ—Ç
  max_workers: 8                    # –ë–æ–ª—å—à–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
  memory_limit_gb: 16               # –ë–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏

# –î–ª—è –±—ã—Å—Ç—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
processing:
  batch_size: 20                    # –ë–æ–ª—å—à–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–∞–∫–µ—Ç
  max_workers: 4                    # –£–º–µ—Ä–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
# –ü—Ä–∏–º–µ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
scanner = DataScanner(config)
results = scanner.run_full_scan(data_dir, output_dir, detectors_config)

# –õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç:
# ‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 245.67—Å
# üìÅ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: 12
# üîç –£—Å–ø–µ—à–Ω—ã—Ö –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤: 6/8
# üéØ –í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞–π–¥–µ–Ω–æ: 1247
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –±–ª–æ–∫–∞–º–∏

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–°–∫–∞–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ë–ª–æ–∫–∞ 11:

```
data/canon/
‚îú‚îÄ‚îÄ quotes/
‚îú‚îÄ‚îÄ book_top/
‚îú‚îÄ‚îÄ tape/
‚îú‚îÄ‚îÄ nbbo/
‚îú‚îÄ‚îÄ basis/
‚îî‚îÄ‚îÄ features/
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –±–ª–æ–∫–µ 14 (–ë—ç–∫—Ç–µ—Å—Ç)
scan_results = run_scanner(scanner_config, detectors_config)

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∞
events_for_backtest = {}
for detector_name, events_df in scan_results.items():
    if not events_df.empty:
        events_for_backtest[detector_name] = events_df

# –ü–µ—Ä–µ–¥–∞—á–∞ –≤ –±—ç–∫—Ç–µ—Å—Ç
from oflow.blocks.backtest import run_backtest
backtest_results = run_backtest(events_for_backtest, backtest_config)
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```
INFO:  –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
DEBUG: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–∞—Ö –∏ –ø–∞–∫–µ—Ç–∞—Ö
WARN:  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –¥–∞–Ω–Ω—ã–º–∏
ERROR: –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

```
INFO: üöÄ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—Ç–µ–∫—Ü–∏–∏
INFO: –≠—Ç–∞–ø 1/4: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤...
INFO: ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω –∏–Ω–¥–µ–∫—Å —Ñ–∞–π–ª–æ–≤
INFO: –ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ –ø–æ —Ç–∏–ø–∞–º:
INFO:   - quotes: 30 —Ñ–∞–π–ª–æ–≤
INFO:   - book_top: 30 —Ñ–∞–π–ª–æ–≤
INFO:   - tape: 30 —Ñ–∞–π–ª–æ–≤
INFO: === –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ 2.45—Å ===

INFO: –≠—Ç–∞–ø 2/4: –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤...
INFO: –°–æ–∑–¥–∞–Ω–æ 8 –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤

INFO: –≠—Ç–∞–ø 3/4: –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö...
INFO: –°–æ–∑–¥–∞–Ω–æ 12 –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

INFO: –≠—Ç–∞–ø 4/4: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤...
INFO: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ 12 –ø–∞–∫–µ—Ç–æ–≤ (4 –≤–æ—Ä–∫–µ—Ä–∞)...
INFO: ‚úì –ü–∞–∫–µ—Ç 1 –∑–∞–≤–µ—Ä—à–µ–Ω
INFO: ‚úì –ü–∞–∫–µ—Ç 2 –∑–∞–≤–µ—Ä—à–µ–Ω
...

INFO: üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø:
INFO: ‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 245.67—Å
INFO: üìÅ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: 12
INFO: üîç –£—Å–ø–µ—à–Ω—ã—Ö –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤: 6/8
INFO: üéØ –í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞–π–¥–µ–Ω–æ: 1247
INFO:   - D1LiquidityVacuumBreak: 45 —Å–æ–±—ã—Ç–∏–π
INFO:   - D4StopRunContinuation: 28 —Å–æ–±—ã—Ç–∏–π
INFO:   - D8MomentumIgnition: 1174 —Å–æ–±—ã—Ç–∏—è
INFO: üéâ –ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```yaml
error_handling:
  continue_on_file_error: true      # –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ —Ñ–∞–π–ª–∞
  continue_on_batch_error: true     # –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–∞–∫–µ—Ç–∞
  continue_on_detector_error: true  # –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞
  max_consecutive_errors: 5         # –ú–∞–∫—Å–∏–º—É–º –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

1. **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π —Ñ–∞–π–ª**
   ```
   WARNING: –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è /path/to/file.parquet: File corrupted
   ```
   **–†–µ—à–µ–Ω–∏–µ**: –§–∞–π–ª –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏**
   ```
   ERROR: –ü–∞–∫–µ—Ç 5: –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
   ```
   **–†–µ—à–µ–Ω–∏–µ**: –£–º–µ–Ω—å—à–∏—Ç—å `batch_size` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
   ```
   WARNING: –ü–∞–∫–µ—Ç 3: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ ['book_top'], –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–µ—Ç–µ–∫—Ü–∏—é
   ```
   **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## Troubleshooting

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```yaml
# –†–µ—à–µ–Ω–∏–µ: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
processing:
  max_workers: 8        # –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
  batch_size: 5         # –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞
  
performance:
  optimize_memory_usage: true
  cleanup_temp_data: true
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
```yaml
# –†–µ—à–µ–Ω–∏–µ: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
processing:
  memory_limit_gb: 4
  batch_size: 3
  max_workers: 2
```

### –î–∞–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª—ã
```yaml
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
filters:
  date_range:
    start: null         # –£–±—Ä–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    end: null
  exchanges: []         # –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
  symbols: []
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –Ω–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
- –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤

### –û—Ç–ª–∞–¥–∫–∞

```python
# –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
import logging
logging.basicConfig(level=logging.DEBUG)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
config['modes']['development']['enabled'] = True
config['modes']['development']['limit_files_per_type'] = 5
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é

```python
config = {
    'processing': {'batch_size': 10, 'max_workers': 4},
    'filters': {
        'date_range': {'start': '20241201', 'end': '20241207'},
        'exchanges': ['binance']
    }
}

results = run_scanner(config, detectors_config)
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∏—Ä–∂–∏

```python
config = {
    'filters': {'exchanges': ['bybit']},
    'processing': {'max_workers': 2}
}

results = run_scanner(config, detectors_config)
```

### –ü—Ä–∏–º–µ—Ä 3: –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
config = {
    'modes': {
        'development': {
            'enabled': True,
            'limit_files_per_type': 5
        }
    },
    'processing': {'batch_size': 2}
}

results = run_scanner(config, detectors_config)
```

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Dask/Ray –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
3. **–£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
4. **Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
5. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
